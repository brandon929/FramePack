bucket_options = {
    320: [
        (208, 480),
        (224, 432),
        (240, 416),
        (256, 384),
        (272, 352),
        (288, 336),
        (304, 320),
        (320, 304),
        (336, 288),
        (352, 272),
        (384, 256),
        (416, 240),
        (432, 224),
        (480, 208),
    ],
    416: [
        (272, 640),
        (288, 560),
        (304, 528),
        (320, 480),
        (352, 464),
        (368, 432),
        (384, 416),
        (416, 384),
        (432, 368),
        (464, 352),
        (480, 320),
        (528, 304),
        (560, 288),
        (640, 272),
    ],
    480: [
        (304, 704),
        (320, 624),
        (352, 624),
        (368, 560),
        (400, 528),
        (416, 496),
        (448, 480),
        (480, 448),
        (496, 416),
        (528, 400),
        (560, 368),
        (624, 352),
        (624, 320),
        (704, 304),
    ],
    640: [
        (416, 960),
        (448, 864),
        (480, 832),
        (512, 768),
        (544, 704),
        (576, 672),
        (608, 640),
        (640, 608),
        (672, 576),
        (704, 544),
        (768, 512),
        (832, 480),
        (864, 448),
        (960, 416),
    ],
}


def find_nearest_bucket(h, w, resolution=640):
    min_metric = float('inf')
    best_bucket = None
    for (bucket_h, bucket_w) in bucket_options[resolution]:
        metric = abs(h * bucket_w - w * bucket_h)
        if metric <= min_metric:
            min_metric = metric
            best_bucket = (bucket_h, bucket_w)
    return best_bucket

